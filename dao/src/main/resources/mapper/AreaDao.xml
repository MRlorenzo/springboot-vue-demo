<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="org.spmul.dao.AreaDao">
	<cache-ref namespace="org.spmul.dao.AreaDao"/>
	<cache readOnly="true"/>

	<!-- 可根据自己的需求，是否要使用 -->
    <resultMap type="org.spmul.entity.AreaEntity" id="areaMap">
        <result property="areaId" column="area_id"/>
        <result property="name" column="name"/>
        <result property="enName" column="en_name"/>
        <result property="areaCode" column="area_code"/>
        <result property="remarks" column="remarks"/>
        <result property="createTime" column="create_time"/>
    </resultMap>

	<select id="queryObject" resultMap="areaMap">
		select * from tb_area where area_id = #{value}
	</select>

	<sql id="queryListWhereSql">
		<where>
			<if test="name != null and name !='' ">
				name like concat('%',#{name}, '%')
			</if>
			<if test="enName != null and enName !='' ">
				and en_name like concat('%',#{enName}, '%')
			</if>
			<if test="remarks != null and remarks != '' ">
				and remarks like concat('%',#{remarks}, '%')
			</if>
			<if test="areaCode != null and areaCode !=''">
				and area_code like concat('%' , #{areaCode} , '%')
			</if>
			<if test="day != null and day!=''">
				AND DATE_FORMAT(create_time, '%Y-%m-d') = #{day}
			</if>
			<if test="apiPlayIds != null and apiPlayIds!=''">
				AND area_id IN (SELECT DISTINCT area_id FROM tb_casino WHERE FIND_IN_SET(play_id,#{apiPlayIds}) and  is_del = 0)
			</if>
		</where>
	</sql>

	<select id="queryList" resultMap="areaMap">
		select * from tb_area
		<include refid="queryListWhereSql"/>
        <choose>
            <when test="sidx != null and sidx.trim() != ''">
                order by ${sidx} ${order}
            </when>
			<otherwise>
                order by area_id desc
			</otherwise>
        </choose>
		<if test="offset != null and limit != null">
			limit #{offset}, #{limit}
		</if>
	</select>

 	<select id="queryTotal" resultType="int">
		select count(*) from tb_area
		<include refid="queryListWhereSql"/>
	</select>

	<insert id="save" parameterType="org.spmul.entity.AreaEntity" useGeneratedKeys="true" keyProperty="areaId">
		insert into tb_area
		(
			`name`,
			`en_name`,
			`area_code`,
			`remarks`,
			`create_time`
		)
		values
		(
			#{name},
			#{enName},
			#{areaCode},
			#{remarks},
			#{createTime}
		)
	</insert>

	<update id="update" parameterType="org.spmul.entity.AreaEntity">
		update tb_area
		<set>
			<if test="name != null">`name` = #{name}, </if>
			<if test="enName != null">`en_name` = #{enName}, </if>
			<if test="areaCode != null">`area_code` = #{areaCode}, </if>
			<if test="remarks != null">`remarks` = #{remarks}, </if>
			<if test="createTime != null">`create_time` = #{createTime}</if>
		</set>
		where area_id = #{areaId}
	</update>

	<delete id="delete">
		delete from tb_area where area_id = #{value}
	</delete>

	<delete id="deleteBatch">
		delete from tb_area where area_id in
		<foreach item="areaId" collection="array" open="(" separator="," close=")">
			#{areaId}
		</foreach>
	</delete>

</mapper>
